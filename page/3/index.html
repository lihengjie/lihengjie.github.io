<!doctype html>
<html>
<head>
    <base href="https://lihengjie.github.io/">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="author" content="lihengjie">

<meta name="description" content="">

<title>lihengjie&#39;s blog</title>
<meta name="generator" content="Hugo 0.40.1" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.1.0/styles/pojoaque.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.1.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:400,700" rel="stylesheet" type="text/css">
<link  href="https://lihengjie.github.io//css/theme.min.css" rel="stylesheet" type="text/css">

</head>
<body>
<div class="page-container container-fluid">
<div class="col-md-3 menu">
    <nav class="col-md-3">
    
    <h3 class="home-link"><a href="https://lihengjie.github.io/">Root</a></h3>
    <div id="last-posts" class="open">
        <h3 data-open="last-posts">lihengjie&#39;s blog - Most recent posts</h3>
        <ul>
            
            <li><a href="https://lihengjie.github.io/post/volatile%E7%AC%94%E8%AE%B0/">Volatile笔记</a></li>
            
            <li><a href="https://lihengjie.github.io/post/tcpdump%E7%AC%94%E8%AE%B0/">Tcpdump笔记</a></li>
            
            <li><a href="https://lihengjie.github.io/post/semaphore%E7%AC%94%E8%AE%B0/">Semaphore笔记</a></li>
            
            <li><a href="https://lihengjie.github.io/post/reentrantlock%E7%AC%94%E8%AE%B0/">ReentrantLock笔记</a></li>
            
            <li><a href="https://lihengjie.github.io/post/nio%E7%AC%94%E8%AE%B0/">Nio笔记</a></li>
            
            <li><a href="https://lihengjie.github.io/post/git%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/">Git常用命令</a></li>
            
            <li><a href="https://lihengjie.github.io/post/cron%E8%A1%A8%E8%BE%BE%E5%BC%8F/">Cron表达式</a></li>
            
            <li><a href="https://lihengjie.github.io/post/countdownlatch/">CountDownLatch</a></li>
            
            <li><a href="https://lihengjie.github.io/about/">About Hugo</a></li>
            
        </ul>
    </div>
    

    
    <div id="tags" class="open">
        <h3 data-open="tags">Tags</h3>
        <ul class="tags">
            
            <li><a href="https://lihengjie.github.io/tags/cron">cron</a></li>
            
            <li><a href="https://lihengjie.github.io/tags/git">git</a></li>
            
            <li><a href="https://lihengjie.github.io/tags/java">java</a></li>
            
            <li><a href="https://lihengjie.github.io/tags/nio">nio</a></li>
            
            <li><a href="https://lihengjie.github.io/tags/tcpdump">tcpdump</a></li>
            
            <li><a href="https://lihengjie.github.io/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B">多线程</a></li>
            
        </ul>
    </div>
    

    
    <div id="categories" class="open">
        <h3 data-open="categories">Categories</h3>
        <ul class="categories">
            
            <li><a href="https://lihengjie.github.io/categories/git">git</a></li>
            
            <li><a href="https://lihengjie.github.io/categories/java">java</a></li>
            
            <li><a href="https://lihengjie.github.io/categories/linux">linux</a></li>
            
            <li><a href="https://lihengjie.github.io/categories/%E5%A4%9A%E7%BA%BF%E7%A8%8B">多线程</a></li>
            
        </ul>
    </div>
    
</nav>

</div>
<div class="col-md-9 content">


<div class="articles-list">
    
    <article>
        <h3><a href="https://lihengjie.github.io/post/semaphore%E7%AC%94%E8%AE%B0/">Semaphore笔记</a> - 2019-09-19 17:53:22</h3>
        semaphore note 使用场景举例 semaphore是共享锁，为了最大化cpu使用。所以如果某线程符合条件，会先获取资源
饭店满座，现在来了一家三口，排队。又来了一对情侣，排队。现在，空了一桌，两个位子，如果用semaphore，情侣可以进去用餐。(此处情侣符合条件，可以先用餐，饭店最大化运营)
代码示例 public class TestSemaphore { public static void main(String[] args) { Semaphore semaphore = new Semaphore(10); Thread threadA = new Thread(() -&gt; { try { System.out.println(Thread.currentThread().getName() + &quot;acquire 4&quot;); semaphore.acquire(4); Thread.sleep(2000); semaphore.release(2); System.out.println(Thread.currentThread().getName() + &quot;release 2&quot;); Thread.sleep(3000); semaphore.release(2); System.out.println(Thread.currentThread().getName() + &quot;release 2&quot;); System.out.println(Thread.currentThread().getName() + &quot;ok&quot;); } catch (InterruptedException e) { e.printStackTrace(); } }); threadA.setName(&quot;threadA -- &quot;); Thread threadB = new Thread(() -&gt; { try { System.
    </article>
    
    <article>
        <h3><a href="https://lihengjie.github.io/post/tcpdump%E7%AC%94%E8%AE%B0/">Tcpdump笔记</a> - 2019-09-19 17:53:36</h3>
         tcpdump 抓包命令及wireshark使用 tcpdump 命令 参考网址
tcpdump -i eth0 src host 192.168.0.1 dst host 145.155.25.100 -w /home/test.pcap |命令|说明 |- |-i|指定网卡 |src host|指定源地址 |dst host|指定目标地址 |-w|写入文件
wireshark 使用  导入生成的pcap文件。 使用命令过滤。  wireshark命令 参考网址
 源地址 src.ip == 192.168.0.1 目标地址 dst.ip == 145.155.25.100 端口 tcp.port == 8080 长度 tcp.len &gt; 100 not and or  
    </article>
    
    <article>
        <h3><a href="https://lihengjie.github.io/post/volatile%E7%AC%94%E8%AE%B0/">Volatile笔记</a> - 2019-09-19 17:53:47</h3>
        volatile note volatile 需要了解java的内存模型，原子性，可见性，有序性，
内存模型 Thread-A &ndash;&gt; 工作内存 &ndash;&gt; 主内存
Thread-B &ndash;&gt; 工作内存 &ndash;&gt; 主内存
可见性 线程将主内存的数据读入工作内存，工作内存的读写速度非常高，这样cpu在运行的时候不会卡在读写上。但是这样会导致A线程读到变量i，B线程此时也读到B线程，A+1修改之后写入主内存，B也+1修改写入主内存，造成ABA问题。 此时需要需要volatile的可见性，就是A修改之后，写入主内存，此时B工作内存中的缓存行会失效，B再次读取时会到主内存读取。
volatile修饰的变量在线程的工作内存修改后，其他线程再在其工作内存读取时(注意是去工作内存读取，读取，读取，如果线程已将变量读取，但是尚未操作时，此时程序仍会出错)，会发现已失效，会再去主内存读取。
使用synchronized、lock在释放锁的时候也会将变量的新值刷回主内存，但是开销比较大。
原子性 int a = 1 ; // 原子性 int b = a; // 非原子性，需要读取a，赋值给b a += 1; // 非原子性 a++; // 非原子性  原子操作：要么一次性完成，要么不做。由以上代码得出由数字赋值是原子性操作，变量复制多了一步读取的操作，不是，另外两个的操作是：读取，加一，赋值。所以也不是原子操作。 volatile 不能保证非原子性的操作，可见代码。
有序性 JMM允许编译器和处理器重排序。 as-if-serial:不管怎样重排序，程序的结果不变。 volatile禁止指令重排。 8个happens-before 原则
1.程序顺序规则： 一个线程中的每个操作，happens-before于该线程中的任意后续操作
2.监视器锁规则：对一个线程的解锁，happens-before于随后对这个线程的加锁
3.volatile变量规则： 对一个volatile域的写，happens-before于后续对这个volatile域的读
4.传递性：如果A happens-before B ,且 B happens-before C, 那么 A happens-before C
5.start()规则： 如果线程A执行操作ThreadB_start()(启动线程B) , 那么A线程的ThreadB_start()happens-before 于B中的任意操作
    </article>
    
</div>


<ul class="pagination">
    
    <li>
        <a href="https://lihengjie.github.io/" aria-label="First"><span aria-hidden="true">&laquo;&laquo;</span></a>
    </li>
    
    <li
    >
    <a href="https://lihengjie.github.io/page/2/" aria-label="Previous"><span aria-hidden="true">&laquo;</span></a>
    </li>
    
    
    
    
    
    
        
        
    
    
    <li
    ><a href="https://lihengjie.github.io/">1</a></li>
    
    
    
    
    
    
        
        
    
    
    <li
    ><a href="https://lihengjie.github.io/page/2/">2</a></li>
    
    
    
    
    
    
        
        
    
    
    <li
    class="active"><a href="https://lihengjie.github.io/page/3/">3</a></li>
    
    
    <li
    class="disabled">
    <a href="" aria-label="Next"><span aria-hidden="true">&raquo;</span></a>
    </li>
    
    <li>
        <a href="https://lihengjie.github.io/page/3/" aria-label="Last"><span aria-hidden="true">&raquo;&raquo;</span></a>
    </li>
    
</ul>

</div>
</div>
<script src="https://lihengjie.github.io//js/theme.min.js" type="text/javascript"></script>


</body>
</html>

